<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Nuevo registro | Pendientes Farmacia | HMV</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
</head>

<body>
  <header style="max-width:1100px;margin:18px auto 8px;padding:0 14px;display:flex;align-items:center;justify-content:space-between;gap:12px;">
    <div style="display:flex;align-items:center;gap:12px;">
      <img src="{{ url_for('static', filename='branding/logo_hmv.png') }}" alt="HMV" style="height:38px;">
      <div>
        <div style="font-weight:800;font-size:18px;">Nuevo registro</div>
        <div style="opacity:.75;font-size:13px;">Pendientes de Farmacia (fotos por d√≠a/folio)</div>
      </div>
    </div>

    <nav style="display:flex;gap:10px;flex-wrap:wrap;">
      <a href="{{ url_for('farmacia_pendientes') }}" style="text-decoration:none;padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.08);background:#fff;">‚¨Ö Volver</a>
      <a href="{{ url_for('dashboard') }}" style="text-decoration:none;padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.08);background:#fff;">üè† Inicio</a>
    </nav>
  </header>

  <main style="max-width:1100px;margin:0 auto 28px;padding:0 14px;">
    <section style="background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:16px;padding:16px;">
      <form method="POST" enctype="multipart/form-data" style="display:grid;gap:12px;max-width:640px;">

        <div>
          <label style="display:block;font-size:12px;opacity:.75;margin-bottom:6px;">Fecha *</label>
          <input type="date" name="fecha" required
                 style="padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.15);width:100%;">
        </div>

        <div>
          <label style="display:block;font-size:12px;opacity:.75;margin-bottom:6px;">Folio (opcional)</label>
          <input type="text" name="folio" placeholder="Ej. PF-2026-001"
                 style="padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.15);width:100%;">
        </div>

        <div>
          <label style="display:block;font-size:12px;opacity:.75;margin-bottom:6px;">Notas (opcional)</label>
          <textarea name="notas" rows="3" placeholder="Ej. Turno matutino / faltantes / urgencias‚Ä¶"
                    style="padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.15);width:100%;resize:vertical;"></textarea>
        </div>

        <!-- Fotos -->
        <div>
          <label style="display:block;font-size:12px;opacity:.75;margin-bottom:6px;">Fotos *</label>

          <!-- INPUT √öNICO -->
          <input
            type="file"
            name="fotos"
            id="fotos"
            accept="image/*"
            multiple
            required
            hidden
          >

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:6px;">
            <button type="button" id="btn_fotos_camara"
              style="padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.15);background:#fff;cursor:pointer;font-weight:700;">
              üì∑ C√°mara
            </button>

            <button type="button" id="btn_fotos_galeria"
              style="padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.15);background:#fff;cursor:pointer;font-weight:700;">
              üñºÔ∏è Galer√≠a
            </button>
          </div>

          <div id="fotos_info"
               style="font-size:12px;opacity:.7;margin-top:8px;">
            Obligatorio. Puedes seleccionar varias im√°genes (JPG/PNG/WEBP).
          </div>

          <ul id="fotos_lista"
              style="margin:10px 0 0;padding-left:18px;font-size:13px;opacity:.9;"></ul>
        </div>

        <button type="submit"
                style="padding:12px 14px;border-radius:12px;border:1px solid rgba(0,0,0,.15);background:#fff;cursor:pointer;font-weight:800;">
          Guardar registro ‚úÖ
        </button>

      </form>
    </section>
  </main>

  <script>
    (function () {
      const input = document.getElementById("fotos");
      const info = document.getElementById("fotos_info");
      const lista = document.getElementById("fotos_lista");
      const btnCam = document.getElementById("btn_fotos_camara");
      const btnGal = document.getElementById("btn_fotos_galeria");

      if (!input || !info || !lista || !btnCam || !btnGal) return;

      btnCam.addEventListener("click", () => {
        input.setAttribute("capture", "environment");
        input.click();
      });

      btnGal.addEventListener("click", () => {
        input.removeAttribute("capture");
        input.click();
      });

      input.addEventListener("change", () => {
        lista.innerHTML = "";

        if (!input.files || !input.files.length) {
          info.textContent = "Obligatorio. Puedes seleccionar varias im√°genes (JPG/PNG/WEBP).";
          return;
        }

        info.textContent = `Seleccionadas: ${input.files.length} foto(s).`;

        for (const f of input.files) {
          const li = document.createElement("li");
          li.textContent = f.name;
          lista.appendChild(li);
        }
      });
    })();
  </script>
</body>
</html>
